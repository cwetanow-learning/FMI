<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible"
        content="IE=edge">
  <meta name="viewport"
        content="width=device-width, initial-scale=1">
  <meta name="description"
        content="">
  <meta name="author"
        content="">

  <title>JSON Web Token</title>

  <link href="css/bootstrap.min.css"
        rel="stylesheet">

  <link href="css/styles.css"
        rel="stylesheet">

</head>

<body>

  <div class="container">

    <div class="row">

      <div class="col-md-3">
        <p class="lead">Навигация</p>
        <div class="list-group">
          <a href="#introduction"
             class="list-group-item active">Какво е JWT?</a>
          <a href="#structure"
             class="list-group-item">Структура</a>
          <a href="#usage"
             class="list-group-item">Как се използва?</a>
          <a href="#data-protection"
             class="list-group-item">Защита на данни</a>
          <a href="#verification"
             class="list-group-item">Верифициране на JWT</a>
        </div>
      </div>

      <div class="col-md-9">
        <div class="thumbnail"
             id="introduction">
          <div class="caption-full">
            <h3>
              Какво е JWT?
            </h3>

            <p>JSON Web Token (JWT) is a compact, URL-safe means of representing claims to be transferred between two parties.
              The claims in a JWT are encoded as a JSON object that is used as the payload of a JSON Web Signature (JWS)
              structure or as the plaintext of a JSON Web Encryption (JWE) structure, enabling the claims to be digitally
              signed or integrity protected with a Message Authentication Code (MAC) and/or encrypted.
            </p>

            <p>
              <strong> JWT работи с различни програмни езици:</strong> .NET, Python, Node.js, Java, PHP, Ruby, Go, JavaScript, и Haskell.
              Вижда се, че може да бъде използван в много различни сценарии.
            </p>

            <p>
              <strong> JWT е самостоятелен:</strong> Всичката нужна информация се съдържа в него. Това означава, че един JWT е способен
              да пренася основна информация за себе си, товар (обикновено информация за потребителя) и подпис.
            </p>

            <p>
              <strong> JWTs се предават по мрежата лесно:</strong> След като JWT е самостоятелен и всичката информация се съдържа
              в него, те могат лесно да се използват в HTTP header, когато се аутентикира API. Също така могат да се предават
              и през URL-а на страницата.
            </p>
          </div>
        </div>

        <div class="thumbnail"
             id="structure">
          <div class="caption-full">
            <h3>
              Структура
            </h3>

            <p>
              Всеки JSON Web Token съдържа три елемента:
              <ul class="list-unstyled">
                <li>
                  <a href="#structure-header">header</a>
                </li>
                <li>
                  <a href="#structure-payload">payload</a>
                </li>
                <li>
                  <a href="#structure-signature">signature</a>
                </li>
              </ul>
            </p>
            <div id="structure-header">
              <h4>
                Заглавие (header)
              </h4>

              <p>
                Съставен от 2 части:
                <ul>
                  <li>typ - показва типа, който обикновено е "JWT"</li>
                  <li>alg - алгоритъма, използван за хеширане</li>
                </ul>

                <pre>
  {
    "typ": "JWT",
    "alg": "HS256"
  }             </pre>
              </p>

            </div>
            <div id="structure-payload">
              <hr>
              <h4>
                Товар (payload)
              </h4>

              <p>
                Товарът представлява голяма част от JWT, още наричан JWT искове (claims). В него се съдържа информацията, която се предава,
                както и други данни за token-а. </p>
              <p>Има няколко искове, които се подават. Това включва регистрирани имена (registered claim names), публични имена
                (public claim names) и вътрешни имена (private claim names).
              </p>

              <pre>
  {
    "iss": "mayapp",
    "exp": 1300819380,
    "name": "John Doe",
    "admin": true
  }</pre>
            </div>
            <div id="structure-signature">
              <hr>

              <h4>Подпис (signature)</h4>

              <p>
                Третата и последна част от JSON Web Token е подписа (signature). Той е получен при хеширане на следните компоненти:
                <ul>
                  <li>header</li>
                  <li>payload</li>
                  <li>secret (таен ключ)</li>
                </ul>
                Така се получава третата част:
                <pre>var encodedString = base64UrlEncode(header) + "." + base64UrlEncode(payload);
                  
HMACSHA256(encodedString, 'secret'); </pre> Тайният ключ (secret) се пази от сървъра. С него нашето приложение ще може да верифицира съществуващи JWT,
                както и да подписва нови.
              </p>
            </div>
            <hr>

            <div>
              <p>
                JSON Web Token се получава със следните стъпки:
                <ul>
                  <li>header елемента се кодира в base64</li>
                  <li>payload елемента се кодира в base 64</li>
                  <li>
                    Резултата от кодирането на header и payload елементите се слагат един до друг и се добавя '.' между тях. Полученият низ след
                    това бива хеширан със тайния ключ и така се получава signature елемента.
                  </li>
                  <li>
                    Самият JWT се получава при събиране на трите низа и добавяне на точки между тях.
                  </li>
                </ul>

                <img src="img/structure.png"
                     alt="structure"
                     id="image">
              </p>
            </div>
          </div>
        </div>

        <div class="thumbnail"
             id="usage">
          <div class="caption-full">
            <h3>
              Как се използва?
            </h3>

            <p>
              За да покаже защо и как се използва JWT, е подготвен пример с 3 главни действащи лица - потребител, приложение и аутентикиращ
              сървър (долната диаграма). Аутентикиращият сървър ще предостави JSON Web Token на потребителя, с който той
              може да комуникира с приложението.
            </p>

            <img src="img/usage.png"
                 alt="structure"
                 id="image">
            <p>
              В този пример, потребителят първо се вписва в аутентикиращия сървър, използвайки нужните данни (потребителско име и парола,
              Facebook, Google ...). След това този сървър създава JWT и го изпраща към потребителя. Когато потребителят
              праща HTTP заявки към API-то на приложението, подава и JSON Web Token-а. В този случай, приложението ще бъде
              конфигурирано така, че да верифицира че пристигащият JWT е създаден от достоверен източник. Така вече, когато
              потребителят прави заявки към приложението със закачен JWT, приложението може да верифицира, че тези заявки
              идват от аутентикиран потребител.
            </p>
          </div>
        </div>

        <div class="thumbnail"
             id="data-protection">
          <div class="caption-full">
            <h3>
              Защита на данни
            </h3>

            <p>
              Важно е да се разбере, че целта на използването на JWT не е да крие ценни данни по никакъв начин. Причината за използването
              на token-а е да покаже, че изпратените данни са всъщност създадени от автентичен източник (сървъра).
            </p>
            <p>
              Данните в JWT са кодирани и подписани, но не са криптирани. Целта на кодирането на данните е, за да се промени структурата
              им. Подписването на данните се прави, за да може получателят да верифицира автентичността на източника на данните.
              Кодирането и подписването на данните не гарантира тяхната защита. Основната цел на криптирането е да подсигури
              данните и да предотврати неоторизиран достъп.
            </p>
            <h4>
              <strong>
                След като JSON Web Token е само подписан и кодиран, а не криптиран, не гарантира никаква защита на ценни данни.
              </strong>
            </h4>
          </div>
        </div>

        <div class="thumbnail"
             id="verification">
          <div class="caption-full">
            <h3>
              Верифициране на JWT
            </h3>

            <p>
              В нашият прост пример използваме JWT, подписан от HS256 алгоритъм и само сървъра знае какъв е тайният ключ. След като само
              приложението знае тайния ключ, когато потребителят направи HTTP заявка със добавен JSON Web Token към API-то
              на приложението, то може да извърши същата операция по хеширане. След това може да верифицира, че хешът получен
              от операцията е същият като този в token-а. Ако съвпадат, то означава че JWT е валиден и показва, че HTTP заявката
              идва от оторизиран потребител. Ако не съвпадат, значи JSON Web Token-а е невалиден и може да е знак, че има
              потенциална атака към приложението. Като валидира JWT, приложението добавя слой на доверие между себе си и
              потребителя.
            </p>
          </div>
        </div>

      </div>
    </div>

    <div class="container">
      <hr>
      <footer>
        <div class="row">
          <div class="col-lg-12">
            <!-- <p>Иван Младенов, ф.н 61950, СИ</p> -->
          </div>
        </div>
      </footer>

    </div>
  </div>
  <script src="javascript/jquery.min.js"></script>

  <script src="javascript/bootstrap.min.js"></script>


</body>

</html>